# ğŸ—ï¸ Architecture Overview

à¸ à¸²à¸à¸£à¸§à¸¡à¸ªà¸–à¸²à¸›à¸±à¸•à¸¢à¸à¸£à¸£à¸¡à¸‚à¸­à¸‡ dLNk IDE

---

## ğŸ“‹ System Architecture

### High-Level Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      dLNk IDE (Desktop)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  VS Code    â”‚  â”‚  dLNk       â”‚  â”‚  AI Chat            â”‚  â”‚
â”‚  â”‚  Core       â”‚  â”‚  Extension  â”‚  â”‚  Panel              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                           â”‚                                  â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚                    â”‚  AI Bridge  â”‚                          â”‚
â”‚                    â”‚  (Local)    â”‚                          â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ gRPC / HTTP
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚                    â”‚  Antigravity â”‚                          â”‚
â”‚                    â”‚  Proxy       â”‚                          â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                           â”‚                                  â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚         â”‚                 â”‚                 â”‚               â”‚
â”‚    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”           â”‚
â”‚    â”‚ Jetski  â”‚      â”‚ Gemini  â”‚      â”‚ OpenAI  â”‚           â”‚
â”‚    â”‚ API     â”‚      â”‚ API     â”‚      â”‚ API     â”‚           â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                              â”‚
â”‚                      AI Providers                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚         â”‚                 â”‚                 â”‚               â”‚
â”‚    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”           â”‚
â”‚    â”‚ License â”‚      â”‚ Admin   â”‚      â”‚Telegram â”‚           â”‚
â”‚    â”‚ Server  â”‚      â”‚ Console â”‚      â”‚  Bot    â”‚           â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                              â”‚
â”‚                    Backend Services                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§© Components

### 1. VS Code Core

**à¸„à¸³à¸­à¸˜à¸´à¸šà¸²à¸¢:** Fork à¸ˆà¸²à¸ Microsoft VS Code à¸à¸£à¹‰à¸­à¸¡ Branding à¹ƒà¸«à¸¡à¹ˆ

**à¸à¸²à¸£à¸›à¸£à¸±à¸šà¹à¸•à¹ˆà¸‡:**
- à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸Šà¸·à¹ˆà¸­à¹€à¸›à¹‡à¸™ "dLNk IDE"
- à¸–à¸­à¸” Telemetry à¹à¸¥à¸° Microsoft services
- à¹€à¸à¸´à¹ˆà¸¡ Custom Theme
- à¸›à¸£à¸±à¸š Default Settings

**à¹„à¸Ÿà¸¥à¹Œà¸ªà¸³à¸„à¸±à¸:**
```
vscode-fork/
â”œâ”€â”€ product.json          # Branding, URLs
â”œâ”€â”€ package.json          # Dependencies
â”œâ”€â”€ src/vs/
â”‚   â”œâ”€â”€ workbench/        # UI components
â”‚   â””â”€â”€ platform/         # Platform services
â””â”€â”€ resources/
    â””â”€â”€ icons/            # App icons
```

---

### 2. dLNk Extension

**à¸„à¸³à¸­à¸˜à¸´à¸šà¸²à¸¢:** Extension à¸«à¸¥à¸±à¸à¸—à¸µà¹ˆà¹ƒà¸«à¹‰ AI Features

**Features:**
- AI Chat Panel
- Code Completion
- Code Explanation
- Bug Detection
- Refactoring

**à¹„à¸Ÿà¸¥à¹Œà¸ªà¸³à¸„à¸±à¸:**
```
extension/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ extension.ts      # Entry point
â”‚   â”œâ”€â”€ chatPanel.ts      # Chat UI (Webview)
â”‚   â”œâ”€â”€ aiClient.ts       # AI communication
â”‚   â”œâ”€â”€ completion.ts     # Code completion
â”‚   â””â”€â”€ commands.ts       # VS Code commands
â”œâ”€â”€ webview/
â”‚   â”œâ”€â”€ chat.html         # Chat UI HTML
â”‚   â”œâ”€â”€ chat.css          # Chat styles
â”‚   â””â”€â”€ chat.js           # Chat logic
â””â”€â”€ package.json          # Extension manifest
```

**Extension API:**
```typescript
// extension.ts
export function activate(context: vscode.ExtensionContext) {
    // Register Chat Panel
    const chatProvider = new ChatPanelProvider(context);
    context.subscriptions.push(
        vscode.window.registerWebviewViewProvider('dlnk.chatPanel', chatProvider)
    );
    
    // Register Completion Provider
    const completionProvider = new AICompletionProvider();
    context.subscriptions.push(
        vscode.languages.registerInlineCompletionItemProvider(
            { pattern: '**' },
            completionProvider
        )
    );
    
    // Register Commands
    registerCommands(context);
}
```

---

### 3. AI Bridge

**à¸„à¸³à¸­à¸˜à¸´à¸šà¸²à¸¢:** Service à¸—à¸µà¹ˆà¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­ Extension à¸à¸±à¸š AI Providers

**Features:**
- Multi-provider support
- Automatic fallback
- Token management
- Rate limiting
- Prompt filtering

**Architecture:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              AI Bridge                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  WebSocket  â”‚  â”‚  REST API       â”‚   â”‚
â”‚  â”‚  Server     â”‚  â”‚  Server         â”‚   â”‚
â”‚  â”‚  (8765)     â”‚  â”‚  (8766)         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                  â”‚            â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                  â”‚                      â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚         â”‚ Provider       â”‚              â”‚
â”‚         â”‚ Manager        â”‚              â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                 â”‚                       â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚    â”‚            â”‚            â”‚          â”‚
â”‚ â”Œâ”€â”€â–¼â”€â”€â”    â”Œâ”€â”€â”€â–¼â”€â”€â”€â”   â”Œâ”€â”€â”€â–¼â”€â”€â”€â”       â”‚
â”‚ â”‚Anti â”‚    â”‚Gemini â”‚   â”‚OpenAI â”‚       â”‚
â”‚ â”‚grav â”‚    â”‚       â”‚   â”‚       â”‚       â”‚
â”‚ â””â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**à¹„à¸Ÿà¸¥à¹Œà¸ªà¸³à¸„à¸±à¸:**
```
backend/ai-bridge/
â”œâ”€â”€ bridge.py             # Main entry
â”œâ”€â”€ websocket_server.py   # WebSocket server
â”œâ”€â”€ rest_server.py        # REST API server
â”œâ”€â”€ provider_manager.py   # Provider selection
â”œâ”€â”€ providers/
â”‚   â”œâ”€â”€ antigravity.py    # Antigravity gRPC
â”‚   â”œâ”€â”€ gemini.py         # Gemini API
â”‚   â”œâ”€â”€ openai.py         # OpenAI API
â”‚   â””â”€â”€ ollama.py         # Ollama local
â”œâ”€â”€ token_manager.py      # Token handling
â”œâ”€â”€ prompt_filter.py      # Security filter
â””â”€â”€ proto/
    â””â”€â”€ antigravity.proto # gRPC definitions
```

---

### 4. Antigravity Proxy

**à¸„à¸³à¸­à¸˜à¸´à¸šà¸²à¸¢:** Proxy à¸ªà¸³à¸«à¸£à¸±à¸šà¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­ Jetski API à¸œà¹ˆà¸²à¸™ gRPC

**Protocol:**
- gRPC over HTTP/2
- Binary Protobuf encoding
- Bearer Token authentication

**Endpoint:**
```
https://antigravity-worker.google.com/exa.language_server_pb.LanguageServerService/SendUserCascadeMessage
```

**Token Flow:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User   â”‚â”€â”€â”€â”€â–¶â”‚ Token       â”‚â”€â”€â”€â”€â–¶â”‚ Antigravity â”‚
â”‚         â”‚     â”‚ Manager     â”‚     â”‚ gRPC        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â”‚ Refresh every 55 min
                       â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ OAuth2      â”‚
                â”‚ googleapis  â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 5. License Server

**à¸„à¸³à¸­à¸˜à¸´à¸šà¸²à¸¢:** Server à¸ªà¸³à¸«à¸£à¸±à¸šà¸ˆà¸±à¸”à¸à¸²à¸£ License

**Features:**
- License validation
- Hardware binding
- Usage tracking
- Expiry management

**API Endpoints:**
```
POST /verify              # Verify license
POST /activate            # Activate license
POST /deactivate          # Deactivate license
GET  /status              # Get license status
```

**Database Schema:**
```sql
CREATE TABLE licenses (
    id INTEGER PRIMARY KEY,
    license_key VARCHAR(25) UNIQUE,
    email VARCHAR(255),
    type VARCHAR(20),
    status VARCHAR(20),
    hardware_id VARCHAR(64),
    created_at TIMESTAMP,
    expires_at TIMESTAMP,
    last_used TIMESTAMP
);

CREATE TABLE usage_logs (
    id INTEGER PRIMARY KEY,
    license_id INTEGER,
    action VARCHAR(50),
    ip_address VARCHAR(45),
    timestamp TIMESTAMP,
    FOREIGN KEY (license_id) REFERENCES licenses(id)
);
```

---

### 6. Admin Console

**à¸„à¸³à¸­à¸˜à¸´à¸šà¸²à¸¢:** Desktop App à¸ªà¸³à¸«à¸£à¸±à¸š Admin

**Features:**
- Dashboard
- License management
- User management
- Log viewer
- Settings

**UI Framework:** CustomTkinter

**Architecture:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Admin Console                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚           UI Layer              â”‚    â”‚
â”‚  â”‚  (CustomTkinter)                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                 â”‚                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚        Controller Layer         â”‚    â”‚
â”‚  â”‚  (Business Logic)               â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                 â”‚                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚         Service Layer           â”‚    â”‚
â”‚  â”‚  (API Client, DB)               â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 7. Telegram Bot

**à¸„à¸³à¸­à¸˜à¸´à¸šà¸²à¸¢:** Bot à¸ªà¸³à¸«à¸£à¸±à¸š Admin à¹ƒà¸Šà¹‰à¸ˆà¸±à¸”à¸à¸²à¸£à¹à¸¥à¸°à¸£à¸±à¸šà¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™

**Features:**
- License management commands
- User management commands
- Alert notifications
- Inline keyboards

**Architecture:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Telegram Bot                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚        Command Handlers         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                 â”‚                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚        Alert Manager            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                 â”‚                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚        Admin API Client         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Data Flow

### AI Chat Request Flow

```
1. User types message in Chat Panel
   â”‚
2. Extension sends to AI Bridge (WebSocket)
   â”‚
3. AI Bridge selects provider
   â”‚
4. Provider sends request (gRPC/REST)
   â”‚
5. Response streams back
   â”‚
6. Extension displays response
```

### License Validation Flow

```
1. User enters license key
   â”‚
2. Client sends to License Server
   â”‚
3. Server validates:
   - Key format
   - Expiry date
   - Hardware binding
   â”‚
4. Server returns status + token
   â”‚
5. Client stores token locally
   â”‚
6. Offline validation for 7 days
```

### Security Alert Flow

```
1. Prompt Filter detects violation
   â”‚
2. Log to database
   â”‚
3. Send alert to Telegram Bot
   â”‚
4. Admin receives notification
   â”‚
5. Admin takes action (suspend/ban)
```

---

## ğŸ” Security Architecture

### Layers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Application Layer             â”‚
â”‚  - Input validation                     â”‚
â”‚  - Output encoding                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Business Layer                â”‚
â”‚  - Prompt filtering                     â”‚
â”‚  - Rate limiting                        â”‚
â”‚  - Anomaly detection                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Data Layer                    â”‚
â”‚  - Encrypted storage                    â”‚
â”‚  - Secure connections                   â”‚
â”‚  - Access control                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Prompt Filter

```python
BLOCKED_PATTERNS = [
    r"attack.*dlnk",
    r"bypass.*license",
    r"steal.*token",
    r"sql.*injection",
    # ... more patterns
]

def filter_prompt(prompt: str) -> tuple[bool, str]:
    for pattern in BLOCKED_PATTERNS:
        if re.search(pattern, prompt, re.IGNORECASE):
            return False, "Blocked: Security violation"
    return True, ""
```

---

## ğŸ“Š Database Architecture

### Entity Relationship

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Users     â”‚â”€â”€â”€â”€<â”‚  Licenses   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
                    â”‚             â”‚
              â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
              â”‚Usage Logs â”‚ â”‚ Hardware  â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ Bindings  â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Tables

| Table | Purpose |
|-------|---------|
| `users` | User accounts |
| `licenses` | License keys |
| `usage_logs` | Activity logs |
| `hardware_bindings` | Device bindings |
| `security_logs` | Security events |
| `admins` | Admin accounts |
| `sessions` | Active sessions |

---

## ğŸ”§ Configuration

### Environment Variables

```bash
# Server
DLNK_HOST=0.0.0.0
DLNK_PORT=8766
DLNK_DEBUG=false

# Database
DLNK_DATABASE_URL=sqlite:///dlnk.db

# Security
DLNK_SECRET_KEY=your-secret-key
DLNK_TOKEN_EXPIRE_HOURS=24

# AI Providers
DLNK_GEMINI_API_KEY=your-key
DLNK_OPENAI_API_KEY=your-key

# Telegram
DLNK_TELEGRAM_BOT_TOKEN=your-token
DLNK_TELEGRAM_ADMIN_CHAT_ID=your-chat-id
```

---

## ğŸ“ˆ Scalability

### Horizontal Scaling

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Load        â”‚
                    â”‚ Balancer    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                 â”‚                 â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
    â”‚ Server  â”‚      â”‚ Server  â”‚      â”‚ Server  â”‚
    â”‚   1     â”‚      â”‚   2     â”‚      â”‚   3     â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
         â”‚                â”‚                â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                   â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
                   â”‚  Database   â”‚
                   â”‚  (Primary)  â”‚
                   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                   â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
                   â”‚  Database   â”‚
                   â”‚  (Replica)  â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**à¸à¹ˆà¸­à¸™à¸«à¸™à¹‰à¸²:** [â† Developer Guide](README.md)  
**à¸–à¸±à¸”à¹„à¸›:** [API Reference â†’](api-reference.md)
